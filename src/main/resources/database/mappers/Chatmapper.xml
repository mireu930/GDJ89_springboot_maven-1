<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.mireu.app.websocket.ChatDAO">
	<select id="getMessageList" resultType="MessageVO" parameterType="MessageVO">
		SELECT * FROM CHAT_TBL
		WHERE RECEIVER=#{receiver} AND STATUS = 3 AND READ_STATUS = 0
		ORDER BY CHAT_NUM DESC
	</select>
	
	<insert id="addChat" parameterType="MessageVO">
		INSERT INTO CHAT_TBL
		VALUES (null, #{roomNum}, #{sender}, #{receiver}, #{body}, now(),#{status},0)
	</insert>
	
	<update id="readMessage" parameterType="MessageVO">
		UPDATE CHAT_TBL SET READ_STATUS = 1 WHERE CHAT_NUM = #{chatNum}
	</update>
	
</mapper>